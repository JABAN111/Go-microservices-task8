# Индексация, поиск и ранжирование. Часть 2.
## Цель
Улучшить скорость микросервиса поиска за счет построения индекса.

Микросервис search в добавок к поиску по базе данных должен предоставить возможность поиска
по индексу. Индекс представляет собой отображение ключевых слов в список идетификаторов комиксов,
в которых эти слова найдены. gateway  должен научиться отвечать на новый запрос:

- "GET /api/isearch?limit=2&phrase=linux,forever" gateway должен отдавать
найденные сервисом search комиксы ответом JSON:
```
{
  "comics": [
    {
      "id": 196,
      "url": "https://imgs.xkcd.com/comics/command_line_fu.png"
    },
    {
      "id": 619,
      "url": "https://imgs.xkcd.com/comics/supported_features.png"
    }
  ],
  "total": 2
}
```

Указан пример ответа. Желательно посылать c gateway отформатированный JSON. Вы должны правильно
обработать входные параметры - для пустого phrase, неправильного limit возвратить bad request.
limit по умолчанию должен принимать значение 10.

search сервис должен принять фразу пользователя, нормализовать ее, найти и отсортировать
релевантные комиксы.

Построение индекса инициируется с помощью "инициатора". Это активный тип адаптера, который
адаптирует, в данном примере, "тики" таймера в вызов метода построения индекса в бизнес-логике.
Инициатор должен конфигурироваться через config.yaml или переменную среды INDEX_TTL. В данном
задании TTL выставлен в 20 секунд для быстрого прохождения тестов и отладки. Запуск инициатора
сопровождается незамедлительным вызовом построения индекса, без ожидания таймера, затем индекс
обновляется по таймеру.

Вам дана структура проекта с частичной имплементацией (пример, можно переделать) в виде популярной
архитектуры Ports & Adapters, она же гексагональная архитектура. Такая архитектура предполагает
принцип инверсии зависимостей. Попробуйте этот принцип реализовать в разрабатываемом сервисе,
а также в API gateway.

Сервисы должны собираться и запускаться через модифицированный compose файл,
а также проходить интеграционные тесты - запуск специального тест контейнера.

## Критерии приемки

1. Микросервисы компилируются в docker image-ы, запускаются через compose файл и проходят тесты.
2. Можно использовать код из предыдущего задания.
3. Сервис search конфигурируeтся через cleanenv пакет и должeн уметь запускаться как с config.yaml
файлом через флаг -config, так и через переменные среды, в этом задании - 
SEARCH_ADDRESS, DB_ADDRESS, WORDS_ADDRESS
4. API gateway должен находить search через конфиг файл или через переменную окружения -
SEARCH_ADDRESS
5. Используется golang 1.23+, slog логгер.

## Материалы для ознакомления

- [Postgres Go library](https://pkg.go.dev/github.com/lib/pq)
- [Go Clean Template](https://www.youtube.com/watch?v=V6lQG6d5LgU)
