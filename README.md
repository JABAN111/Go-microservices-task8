# Индексация, поиск и ранжирование. Часть 1.
## Цель
Создать микросервис, который будет искать по базе данных нужные комиксы.

Mикросервис search должен отвечать по gRPC протоколу в API gateway. 
Нужно реализовать методы RPC в search и соответсвующие REST вызовы в API gateway:


1. По запросу "GET /api/ping" gateway отдает ответ о состоянии поисковых сервисов.
При таком запросе gateway запрашивает по gRPC состояния других микросервисов.
Ответ должен быть в виде JSON:
```
{
    "replies": [
        "words": "ok",
        "update": "ok"
        "search": "ok"
    ]
}
```

2. По запросу "GET /api/search?limit=2&phrase=linux,forever" gateway должен отдавать
найденные сервисом search комиксы ответом JSON:
```
{
  "comics": [
    {
      "id": 196,
      "url": "https://imgs.xkcd.com/comics/command_line_fu.png"
    },
    {
      "id": 619,
      "url": "https://imgs.xkcd.com/comics/supported_features.png"
    }
  ],
  "total": 2
}
```

Указан пример ответа. Желательно посылать c gateway отформатированный JSON. Вы должны правильно
обработать входные параметры - для пустого phrase, неправильного limit возвратить bad request.
limit по умолчанию должен принимать значение 10.

search сервис должен принять фразу пользователя, нормализовать ее, найти и отсортировать
релевантные комиксы. В данном задании не предполагается построение поисковых индексов.

Возможно, Вам придется поменять структуру комиксов в update адаптере, чтобы с сайта XKCD получать
полную информацию о комиксах, то есть поля title, safe_title, transcript и alt. Они могут содержать
поезные ключевые слова.

Вам дана структура проекта с частичной имплементацией (пример, можно переделать) в виде популярной
архитектуры Ports & Adapters, она же гексагональная архитектура. Такая архитектура предполагает
принцип инверсии зависимостей. Попробуйте этот принцип реализовать в разрабатываемом сервисе,
а также в API gateway. В этом задании нет имплементации сервиса search - Вам предстоит по подобию
создать его с нуля, добавить секцию в compose.yaml, создать Dockerfile.search, proto/search и т.п.
Можно ориентироваться на уже разработанные сервисы, например, update.

Сервисы должны собираться и запускаться через модифицированный compose файл,
а также проходить интеграционные тесты - запуск специального тест контейнера.

API gateway должен уметь контактировать с search через переменую среды SEARCH_ADDRESS.

## Критерии приемки

1. Микросервисы компилируются в docker image-ы, запускаются через compose файл и проходят тесты.
2. Можно использовать код из предыдущего задания.
3. Сервис search конфигурируeтся через cleanenv пакет и должeн уметь запускаться как с config.yaml
файлом через флаг -config, так и через переменные среды, в этом задании - 
SEARCH_ADDRESS, DB_ADDRESS, WORDS_ADDRESS
4. API gateway должен находить search через конфиг файл или через переменную окружения -
SEARCH_ADDRESS
5. Используется golang 1.23+, slog логгер.

## Материалы для ознакомления

- смотрите предыдущие задания.
